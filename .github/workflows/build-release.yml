name: æ„å»ºå’Œå‘å¸ƒ

on:
  push:
    tags:
      - 'v*'  # å½“æ¨é€ v å¼€å¤´çš„ tag æ—¶è§¦å‘ï¼ˆå¦‚ v1.0.0ï¼‰

jobs:
  build-windows:
    runs-on: windows-latest
    
    steps:
    - name: æ£€å‡ºä»£ç 
      uses: actions/checkout@v4
    
    - name: è®¾ç½® Python
      uses: actions/setup-python@v5
      with:
        python-version: '3.11'
    
    - name: å®‰è£…ä¾èµ–
      run: |
        python -m pip install --upgrade pip wheel
        pip install -r requirements.txt
        pip install pyinstaller
    
    - name: ä½¿ç”¨ PyInstaller æ‰“åŒ…
      run: |
        pyinstaller label_bundle.spec
    
    - name: å‹ç¼©æ‰“åŒ…æ–‡ä»¶
      run: |
        cd dist
        Compress-Archive -Path "æ ‡ç­¾æ‰“å°å·¥å…·" -DestinationPath "LabelPrinter-Windows-x64.zip"
    
    - name: è·å–ç‰ˆæœ¬å·
      id: get_version
      run: |
        $version = "${{ github.ref_name }}"
        echo "version=$version" >> $env:GITHUB_OUTPUT
      shell: pwsh
    
    - name: åˆ›å»º Release
      uses: softprops/action-gh-release@v1
      with:
        files: dist/LabelPrinter-Windows-x64.zip
        body: |
          ## ğŸ·ï¸ æ ‡ç­¾æ‰“å°å·¥å…· ${{ steps.get_version.outputs.version }}
          
          ### ğŸ“¦ ä¸‹è½½è¯´æ˜
          - **Windows ç”¨æˆ·**ï¼šä¸‹è½½ `LabelPrinter-Windows-x64.zip` å¹¶è§£å‹
          - è§£å‹åè¿è¡Œ `æ ‡ç­¾æ‰“å°å·¥å…·.exe` å³å¯ä½¿ç”¨
          
          ### âœ¨ ä¸»è¦åŠŸèƒ½
          - Material Design é£æ ¼ç•Œé¢
          - æ”¯æŒä¸­æ–‡/æ³°è¯­åŒè¯­
          - PDF é¢„è§ˆå’Œç”Ÿæˆ
          - å‚æ•°è‡ªåŠ¨ä¿å­˜
          - ç²¾è‡´çš„åŠ è½½åŠ¨ç”»
          
          ### ğŸ“‹ æ›´æ–°å†…å®¹
          è¯·åœ¨æ­¤å¤„å¡«å†™æœ¬æ¬¡æ›´æ–°çš„è¯¦ç»†å†…å®¹...
          
        draft: false
        prerelease: false
      env:
        GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
